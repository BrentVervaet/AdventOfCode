puzzle_input = '''YYYYYYYYYEJJEEEEEEEEEEEEEEGGGGGGGGGGGGGGGGGGCCCCCCCCCCWWCCLLLKKKKJKKKKKKFFFFFFFBBBBBBBBBBBAEEEEEEEEEEEEPPPPPPPPPOOOOZYYYZZZZZZAAUUUUUUUUUUUU
YYYYYYYYNEEEEEEEEEEEEEEEEEGGGGGGGGGGGGGGGGGCCCCCCCCCCCCCCCLLLLKKKKKKKKKKKFFFFFBBFBOBBBBBBBBBEEEEEEEEEEEPPPPPPOOOOOOOZZZZZZZZZZZAAUKUUUUUUUUU
YYYYYYNNNNYEEEEEEEEEEEEEEEGGGGGGGGGGGGGGGGGGCCCCCCCCCCCCCCCCLKKKKKKKKKKKKFFFFFFFFBBBBBBBBBBBBEEEEEEEEPPPPPPPOOOOOOOOOZZZZZZZZZUUUUUUUUUUUUUU
YYYNNNNNNNEEEEEEEEEEEEEEEEEGGGGGGGGGGGGGGGVVVVCCCCCCCCCRREEEEKKKKKKKKKKKKFFFFFFXFBBBBBBMMBBBBBEEEEEFEPPPPPPOOOOOOOOOOOZZZZZZZZZZUUUUUUUUUUUU
YYYNNNNNNWWEEEEEEEEEEEEEEEEGGGGGGGGGGGGGGGWVVVVVCCCCCCRRREEMEEKKKKKKKKKKKFFFFFXXFFBBBMBMMEEEEEEEEEEEPPPPPPPOOOOOOOOOOOZZZZZZZZZUUUUUUUUUUUUU
YYNNNNNNNNEEEEEEEEEEEEEEEEEEIIIIGGGGGGGGGWWWVVVVVCCCCCCEEEEMEKKKKKKKKKKKKKFFFFXXXBBBMMMMMEEEEEEEEEEEPPPPPPPPOOOOOOOOOOOOZZZZUUZUUUUUUUUUUUUU
YNNNNNNNNNNEEEEEEEEEEEEEEEEEIIIIGGGGGGGWWWWVVVVWWWWCWCCWEEMMMKKKKKKKKKKKKKFFFFXXXXXXMMMMEEEEEEEEEEEPPPPHHHHPPOOOOOOOOOOOZZZUUUUUUUUUUUUUUUUN
NNNNNNNNNNNNEEKEEKKKVEEEEEEIIIIIGIGGVGGGWCWWWWVVVWWWWCWWMMMMKKKKKKKKKKKKKKXXXXXXXXXXMMMMMEEEEEEEEEEPPHHHHHHPPOOOOOOOOOOOZZZUUUUUUUUUUUUUUUUN
NNNNNNNNNNNNAKKKKKKKKEEEEEEIIIIIIIGVVGGGWCCWWWWWWWWWWWWWWMMMMMMBBBKKKKBKKKBBXXXXXXXXMMXMMMEMMEEEEEQCPCHHHHHHPPOOOVVVOOOOZOOOOUUUUUUUUUUUUUNN
JJNNNNNNNNNNNKKKKKKKKEEEETTTTTTTTTGGGGGGCCCWWWWMWMMWWWWWWWMMMMMMMBBBKBBBKBBBBXXXXXXXXXXMMMMMMEEEQQQCCCHHHHHHHPVOOVVVOVOOOOOOOOOUUUUUUUUUUNNN
JJNNJNNNNNNJKKKKKKKKKKEEETTTTTTTTTTTIGGGCCCCWWWMMMMMWWWWWWWWWWMMKVBBBBNBBBBBBXXXXXXXXXXMMMMMMEEQQYQCCCHHHHHHHVVOOVVVVVOOOOOOOOOOUUQQUUUUNNNN
JJNNJNNNJJJJJKKKKKKKKKKKZTTTTTTTTTTTTTCGCCCCWWWMMMMMWWWWWWWWWWMVKVBBBNNNNBBBBXXXXXXBXNMMMMMMMMHQQQQCCCCHHHHHVVVHVVVVVVVVOOOFFFOOQQQQUNNNNNNN
JJJJJNNNJJJJJJKKKKKKKKKZZTTTTTTTTTTTTTCCCCCCCWMMMMWWWWWWWVWWVVVVVVBBBNXNNNNBBBBXXBBBMMMMMMMMMQQQQQQCCCCHHHHHHVVHVVVVVVVVOFFFFFOOQQQQUQNNNNNN
JJJJJNIJJJJJKKKKKKKKKKKKZZZZITTTTTTTTTCCCCCCCCMMMMWWWWWWVVVVVVVVVVVBVNNNNNNNBBBBXBBBBBMMMMMMMKQQQQQQCQCHHHHHHVVVVVVVVVVVVFFFFFOQQQQQQQQNNNNN
JJJJJJJJJJJJJKKKKKKKKKKKZLZZZTTTTTTTTTCCCCCCCCMMMMMMMWVWVVVVVVVVVVVVVNNNNNNNBBBBXBBBBBMMMMMMMQQQQQQQQQHHHHHMHHZVVVVVVVVVVVFFQOOOQQQQQQNNNNNN
JJJJJJJJJJCCCKVKKKKKKKZZZLLLLZZCTTTTCCCCCCCCCCMMMMMMMMVVVVVVVVVVVVVVNNNNNNRRRRRBBBBBMMRRRMMMMMQQQQQQQQMMMXMMMHVVVVVVVVVVVVQQQQQOOOQQQQNNNNNN
JJJJJJJJJJCCCCKKKKKKKZZZLLLLCCCCTTTTTTTTTCCLLMMMMMMMMMTVVVVVVVVVVVVVNNNNNNRRRRRRRBBBMMMMRMMMMQQQQQQQQQMMMMMMMEMVVVVVVVVVVVQQQHQQQQQQQQNNNNNN
JJJJJJJJJJCCCCIKKKKKKZLLLLLDLCCCTTTTTTTTTCLLLMMMMMMMMTTTTVVVVVVVVVVVNNNNNNNRRRRRRRBBMMMMMMMMQQQQQQQQQQMMMMMMMMMMVVVVVVVVVVVVQHHHQQQQNNNNNNNN
JJJJJJJJJCCCCCIKKKKKZZLLLLLLLCCCTTTTTTTTTCCLLLLLMMMEMTTTIIIIVVVVVVVVNNNNNNNNRRRRRRRRMMMMMMMMMQQQQQQQQMMMMMMMMMMMVVVVVVVVVVVVQHHHHQQQQNNNNNNN
JJJJJJDJCCCCCCCCKKKKKCLLLLLLLCCCTTTTTTTTTLLLLLLEEMMEITIIIIIIIIIVVVVVNNNNNNNRRRRRRRRJJJMMMMMMMBBQQQQQQMMMMMMMMMVVVVVVVVVVZIHHHHHHHQQQNNKKNNNN
JJJJJJDJCCCCCCCCCCCCCCLLLLSLLZZZZZTTTTTTTLLLLLLLEEEEIIIIIIIIIIIEVVNNNNNNNNRRRRRRRRRRMMMMMMMMBBBQBPQQQMMMMMMMMMVVVVVZVVVVZIHHHHHHHHHNNNNNNNNN
DJJJDDDCCCCCCCCCCCCCCLLLLLSSSZZZZZTTTTTTTLLLLLLLLEEIIIIIIIIIIIIIINNNNNNNNNRRRRRRRRRRMMMMMMMMMBBBBBBMMMMMMMMMMMVVVVVZZZVVZIIIIHHHHHHNNNNNNNNN
DDDJDDCCCCCCCCCCCCCCCLLLLLLSSZZZZZTTTTTTTLLLLLLIEEIIIIIIIIIIIIIIIINNNNNNNCNRRRRRRQQRMMMMMMMMMBBBBBBMMMMMMMMMMMMVVVVZZZZZZIIIIHHHHHHNNNNNNNNN
DDDDDDCCCCCCCCCCCCCCCLLLLSSSSZZZZZTTTTTTTLLLLLLIIIIIIIIIIIIIIIIIPIPNNCNNNCCCCRRRRRMMMMMMMMMMMBBBBBBMMMMMMMMMMMVVVVVZZZZZZIIIHHHHCNNNNNNNNNNN
IDDDDDCCCCCCCCCCCCCCLLNNLSSWSSZZZZTTTTTTTLLLLLIIIIIIIIIIQIQFQQIPPPPPPCNCCCCGCRRRMMMMMMMMMMMMBBBBBBBBBBMMMMMMMMMMMZZZZZZZZIIIHHHHHCNNNNNNNNNN
IIIDDIIYCCCCCCCCCCCLLLLNNSSWWWWZWWWEELLLLLLLLLIIIIIIIIIIQQQQQQPPPPPPCCCCCCCCCRRMMMMMMMMMMMMMBTBBBBBBBBMMMMMMMMMBBBZZZZZZZZIHHHNNNNNNNNNNNNNN
IIIDIIIICCCCCCCCLLLLLLLNNSSWWWWWWWWEEEEELLLLLIIDDDIIIIQQQQQQQQQPPPPPCCCCCCCCCRMMMMMMMMMMMMMMBBBBBBBBZZTMMMMMMMBBBBBBZZZZZZZNNNNNNNNNNNNNNNNN
IIIIIIIIIKCKCCCCXLLLLLNNNSSWWWWWWEEEEEEELLLLLIIDDDIIIQQQQQQQQQPPPPPPPPPCCCCCCRMMMMMMMMMMCCCMTBBBBBZZZZZPMMMMKMBBBBBBZZZCZZZNNNNNNNNNNNNNNNXX
IIIIIIIIIKCCCCCCXLLLLLNNNNNWWWWWWWEEEEELLELLLAIDDDDDDQQQQQQPPPPPPPPPPCCCCCCCCCCCMMMMMMMMMMMMMWBBBZZZZZLLLMMKKSBBSBBBZZZXZZZNNNNNNNNNNNNNNNXX
IIIIIIIIIXCCCCXXXXXLLLNNNYNVWWWWWEEEEEELEELLLLDDDDDDDQQQQQQPPPPPPPPPCCCCCCCCCCCCCMMMMMMMMMMMMWWZZZZZZZZLLULLKSSSSBSBXNNXXRXXNNNNNNNNNNNXXXXX
IIIIIIIIIXXCCXXXXXXXNNNNNYNVBBBWWBEEEEEEELLDDDDDDDDDDQQQQQQQQQPPPPPPPCCCCCCCCCCCCMMMMFFMMMMNMZZZZZZZZZLLLULLKSSSSSSXXXNXXXXXXNNNNNNNNNNXXXXX
IIIIIIIXXXXXXXXXXXNAANNNNYNNBBBBBBBEJJEAEDDDDDDDDDQQQQQQQQQQPQPPPPPPPCCCCCCCCCCCTFFFFFFFMMMMMMMUZZZZZZLLLLLLLSSSSSSSXXXXXXXNNNNNNNNNNNNXXXXX
IIIIIIIXXXXXXXXXXXNAANNNNNNNBBBBBBBJJJDDEDDDDDDDBBIIIQQQQQQQPPPPPPPCCCCCCCCCCCCUFYFFFFFNFMMMMEUUZZZZZAALLLLLLSSSSSSXXXXXXXXNNNNNNNNNNGGGXXXX
IIIIIIIIIXXXXXXXXNNNNNNNNNDNBBBBBBBBJJDDDDDDDDDBBIIIQQQQQQQQPQPPRPPCCCCCCCCCCCCFFFFFFFFFFFFMEEUUZZQZQLLLLQSSLSSSSSSSXXXXXXXNNNNNNNNGGVGGGXXX
IIIIIIIXXXXXXXXXXXXNNNNNNDDDBBBBBBBJJJDDDDDDDBBBBBBBQQQQQQQQQQPCRRRCCCCCCCCCCYYYYFFFFFFFFFFUUUUUUZQQQLLLLQSSSSSSSSSSXXXXXXNNNNNNNNNGGGGGXXGG
IIIIIIIIXXXXXXXXXXXNNNNNDDBBBBBBBBBBBDDDDDDDBBBBBBBBQQQQQQQQQQPCRRCCCCCCCCCCCYYYFFFFFFFFFFTTUUUUUQQQQQQLLQQQSSSSSSSXXXXXXXXNNNNNNNNGGGGGGGGG
IIIIIIXXXXXXXXXXXXXXNNNNDDBBBBBBBBBJJDDDDDDDBBBBBBBBBBQQQQQQCCCCCRCCCCCCCCCYYYYYYYFFFFFFFZTTTUUUQQQQQQQQQQQQQSSSSSXXXXXXXXNNNNNNNNNNGGGGGGGG
IIIIIIIXXXXXXXXXXXXNNNNNNNNVVBBBBBBJJJJDDDDDBBBBBBBBBBBQQQQQQQCCCCCCCCCYCCYYYYYYYYYFFFFFFZTTTZQQQQQQQSSSQQQQSSSSSSXXXXXXXXXNNNNNNGGGOGGGGGGG
IIINNNNZCXCXXCCXXXXNNNNVVVVVVBBBJJBBJJJDDKDKBBBBBBBTTBBQQQUQQQCCCCCCCYYYYCYYYYYYYYYFFFZZZZZZZZZQQQQSSSSSQQQQQQXXXXXXXXXXXXXNNNNNNGGGGGGGGGGG
NNNNNNNZCCCXCCXXXXXXNNNOVVVVVBBBJJBBJJJJDKKKBBFTTTTTTBBQQQQQQCCCCCCCCYYYYYYYYYYYYYYZQQZZZZZZZZZZSSSSSSSSQSQQQQXXXXXXXXXXKXXNNNNNNNGGGGGGGGGG
CCNNNNNNCCCCCXXXXFFXXNOOOOOVOOBBJJJJJJJJDKKKKKFFTTUTTBTQHQQHQCCCCCCCHYYYYYYYYYYYYZYZZZZZZZZZZZZZSSSSSSSSSSQQXXXXXXXXKXXKKKXNNNNNNNGGGGGGGGGG
CCCCNNNCCCCCXXXXFFFXXXOOOOOVOOJJJJJJJJJJKKKKKKFFFFFFFTTHHQHHQCCCCCCCHYYYYYYYYYYYYZZZZZZZZZZZZZZZSSSHSSSSSSSSFXXXXXXXKKKKKKKNNNNNNNNGGGGGGGGG
CCCCCCNCCCRCXXFXFFFOOOOOOOOOOOJAAAAAAJKKKKKKTTFFFFFFFTTHHHHHCCCCCCCCCYYYYYYYYYYYYYZZZZZZZZZZZZZZSSSSSSSSSSSSFFXXXSXXKKKKKKKNNNNNNNGGGGGGGGGY
CCCCCCCCCCRCCXFFFFFFFOOOOOOOOOOOAAAAAKKKKFFFFFFFFFFFFTTHHHHHHCCCHCCHHHQQYYYYYYYZZZZZZZEEEEEEEZZZZZZSSSSSSSSFFFSXSSXXKKKKKKKKKNNNNNNGGGGGGGGY
CCCCPCCCCCCXXXFFFFFFFOOOOOOOOOOOOAAAKKKKKFFFFFFFFFFFFTTTHHHHHCCCHCHHHHHQQYYYYYYYYYZHZZEEEEEEEZZZZSSSSSSSSSSSSFSSCSXHKKKKKKKKNNNNCCNGGGGGGGGG
CCCCCCCCCCCCXXFFFFTTFOOOOOOOOOOOAAAKKKKKKFFFFFFFTTTTTTTTHHHHHHHHHHHHHHHQQYYYYYYYYYZZZEEEEEEEEEZZZSSSSSSSSSSOSSSSSSSHHHKKKKKKKNCCCCJGGGLGGGGG
SCMMMCCCCCCVVFFFFFFTOOOOOOOOOOAAAAAKKKKKKFFFFFFFTTTTTTTTHHHHHHHHHHHHHHQQRRYYYYYBYYZEEEEEEEEEEEZZZSSSSSSSSSSOSSSSSSSSSKKKKKKRKKKSCCCCCLLLGGLL
SCMMMMMTCTTTTTTFFFTTOOOOOOOOOOAAAAAKKKKKKFFFFFFFTTTTTTTHHHHHHHHXHHHNNNQQRRRRUNNBYMMEEEEEEEEEEEZCCCCCSSSSSSSOSSSSSSSSKKKKKKKRKKKCCCCXCLLLLLLI
SSITMTTTTHTTTTTEETTTOOOOOOIOAAAAAAKKKKKKKFFFFFFFTTTUTTTTHHHHHHHHHHHHNNNRRRREEEEEEEEEEEEEEEEEEECCCCSSSSSSTSSSSSSSSSSSSKQQKKKKKSSCXCCJLLLLLLLL
IIITTTTTTTTTTTTTTTTOOOOOOOOOAQAQQAKKKKKKKKKKKKKTTKUUDTTTTHUHSHHHHHHNNNRRRRREEEEEEEEEEEEEEEEEESSCCEEESSSSTTSSSSSSSSSSSSSSCKEEJJJJJJJJULLLLLUU
IIIIMTTTTTTTTTTTTTTCOOXXOOOOQQAQQKKKKKKKKKKKKKKKKKUUDTTTUUUEUMMHHHHHNPRRRRREEEEEEEEEEEEEEEEEEISCCEEEESMMSSSSSSSSSSSSSSSSJJJEJJJJJJJJULLLLUUU
IIIIMMTTTTTTTTTTTTDOOOXXOOOPQQQQQQYYYNKKKKKKKNNKKKUUUUUUUUUUUMMHHHHPPPRRPRREEEEEEEEEEEEEESSSSSSCCEEEEEEESSSSSSSSSSSSSSSJJJJJJJJJJJJUUUUUUUUU
IIIMMMTRTTTTTTTTTTTEOOOOOOOIQQQQQQYYYNNNNNNNKNNKKKUUUUUUUHUUUMMMMPPPPPPPPFROSXXXXXXEEEEEEXSSSSSXCEEEEEEEBBSSSSSSSSSSSSSFJJJJJJJJJJUUUUUUUUUU
IIITMMMTTTTTTTTTTTTZZZZDDIIIIQIQQQYNNNZNNNNNNNNNKKKUUUUUUUUMMMMMPPPPPPPPFFRRSXXXXXXEEEEEESSSSSXXXXXEEEEEEQSSEEESESSSSSSSRJJJJJJJTNUUNUUUUUUU
IIITTTTTTLTTTTTTTTTZZZZIDIIIIIIQQYYNNNNNNNNNNNNNKKKUUUUUUUUUMMMMPPPPPPPPPSSSSSXXXXXXXXXXXXXSSSXXXXXXEEEEQQQEEEEEESSSSSJSSJJJJJJJTNNNNUUUUUUU
IIIIIIIILLLLTTTTTTTZZZZIIIIIIIIQIAYYNNNNNNNNNNNNNKNUUUUUUUUUMMMPPPPPPPPPPSSSSSSXXXXXXXXXXXXXSXXXXXXXXEEEQQQEEEEEESSSSSSSSJJJJJJJJNANNUUUUUUU
IIIIIIILLLLLZTTTTZZZZZIIIIIIIIIIIAANNNNNNNNNNNNNNNNUUUUUUUUUUMMMPPPPPPPPVVSSSSXDDDDXXXXXXXXXXXXXXXXXEEEEQQQQQEEEYSSSSCSDDDJJJJJJJNNNVVUUUUUU
IIIIIIILLLKLZZZZTZZZZZIIIIIIIIIIIAANNNNNNNNNNNNNNNNUUUUUUUUMMMMMPPPPPPPPPVSSSSXDDDDXXXXXXXXXXXXXXXXHHQCQQQQQQQQQYSSSSSDDDFFJJJJNNNNNVVVVVUUU
IIIIIIILSLKLZZZZTZZZZZZZIIIIIIIIAAANNNNNNNNNNNNNNUUUUUUUUUUUUMMMPPPPPPPPPSSSSSXDDDDXXXXXXXXXXXXXXKKKHQQQQQQQQQQQSSVSDDDDDDJJJJJJNNNNVVVVVVUU
IIIIIIILLLLLZZZZZZZZZZLZLIIIIIIZQAANNNNNNNNNNNNNUUUUUUUUUUUMMMMPPPPPPPPPPPSGGSGDDDDXXXXXXXXXXXXXXKHHHQQQQQQQQQQQQSVDDDDDDDDJRRRNNNNNFVVVVVVV
IIIIIILLLLLLZZZZZLZLLZLLLLIIIIZZZTTTTTNNNNNNNNNUUJUUUUUUUUUUNNMPPPPPPPPPPPSGGGGDDDDXXXXXXXXXXXXXXXHHHHHHQQQQQQQQQVVDDDDDDDRJRRRRNNNLVVVVVVVV
IIIIIILLLLLLLLZZLLLLLLLLLLIIIZZZZTTTTTZNNNNYNNJJUJUJUUUUUUUNNNPPPPPPPPPPPFCCCGGDDDDGXXXXXXXXXXHHHHHHHHHHHHQQQQQQQQQDDDDDDDRRRRNNNNNVVVVVVVVV
RRIPLILLLLLLLLLLLLLLLLLLLLLLIZTTTTTTTTTTZYYYYNJJJJUJJUUUUNNNNNNZPPPPPPPPDDDDDDDDDDDGXXXXXXXXXXXXHHHHHHHHHQQQQQQQQQDDDDDDDDRRRRRNNNRVVVVVVVVV
RRPPLLLLLLLLLZLLLLLLLLLLLLLLIZTTTTZTTTTTZYYYYJJJJJJJNJUUJNNNNNNNRRPPPPCCDDDDDDDDDDDGXCOXXXXXXXXDDHHHHHHHHHQQQQQQQQDDWDDDDRRRRRRRRRRVVVVVVVVV
RPPPLLLLLLLLLZLLLLLLLLLLLLLIIATTTTZTTTTTZZZZYJJJJJJJJJJJJJNNNNNNNRPPPCCCDDDDDDDDDDDGOOOXXXXXXXXXDDHHHHHHHHHQQQQQQQFDWWDDDRRRRRRRRRVVVVVVVVVV
PPPPELLLLLZZZZLLLLLLLLLLLLLLAATTTTZTTTTTTTTPJJJJJJJJJJJJJJJNNNNRRRRPCCCCDDDDDDDDDDDDVOOXXOIOOXXXDDHHHHHHHHQQQQQQQQWWWWVVDRRRRRRRRRRVVVVVVVVV
PWPPPPLLLLLLLZLLLLLLLLLLLLLLAATTTTZZZZTTTTTXXXJJJJJJJJJJJJSNNMMMMRRRRCCCDDDDDDDDDDDDOOOOOOOOOAXXKYHYYYHHHQQQQQQQQQWWWWWWWRRRRRIRRRRVVVVVVVVV
PPPPPYLLLLLLLLLOLLLLLLLLLLLAAATTTTZZZZTTTTTXXXXXJJJJJJJNNJNNNMMMMMRRRRRRDDDDDDDDDDDDOMOOOOOOOAXXKYYYYYYYYQQQQQQHWWWWWWWWWRIIIIIIRZVVVVVVVVVV
PPPPPPPPSSLLLLBBGGLLLLLLLTTTTTTTTTTZZZTTTTTXXXXXJJJJJJJNNNNNNMMMKKMRRRRRDOOOOOOOOODDDDDDDOOOOXXXKKYYYYYYMMQQQQHHWWWWWWWWIIIIITIZZZVVVJVVVVVV
PPPPPPPPPSSLBBBGGGGLLLLLATTTTTTTTTTZZZZZXXXXXXXXXJSJJJJJJJNNNMMMMMMRRRRRDOOOOOOOOODDDDDDDHOOOPPKKKYYYYYYYYQQQQHHHWWWWWWIIIIIIIIWZZZZZVVVVVVV
PPPPPPPPSSBBBBBBBBBBLLLLATTTTTTTTTTZZZZUUXXXXXXXJJJJJWJJJJBNNNNMMMMMRRROOOOOOOOOOODDDDDDDHOPPPPKKKKYYYYYYLQHHHHOHHIIWWIIIIIIIIIIIZZZVVVVVVVV
PPPPPPPPPBBBBBBBBBBAALAAATTTTTTTTTTZZZZZXXXFFFJJJJJJJJJJJJBNNBMMMMMMRRROOOOOOOOOOODDDDDDDOPPPPKKKKAYYYYYLLQHHOOOHHHIIIIIIIIIIIIIIZZZZVVVVVVV
PPPPPPPPPPBBBBBBBBAAAAAANTTTTTTTTTTZUZUXXXYBBFJJBBJJJBBBMMBLLDRRRRRRRRROOOOOOOOOOODDDDDDDIIIIIIIKKAYYKYYYLQAOOOOOOIIIIIIIIIIIIIZZZZZZZVVVVVR
PPPPBBBBPBBBBBBBBBBAAAAANTTTTTTTTTTZUUUXXXYBBBBBBBBJJBBBBBBLLDDRRROOOOOOOOOOOOOOOOOOOOHIIIIIIIIIAAAAYYYYYAAAPPOOOIIIIIIIIIIIIIIIZZZZZZZZVVVR
PPPPPTBBBBBBBBBBBBBAAAANNTTTTTTTTTTZZUUXXUBBBBBBBBBBBBBBBBDDDDDRDROOOOOOOOOOOOOOOOOAOOHIIIIIIIAAAAAAAAAAYAAAAAWWOWIIIIIIIIIIIOOIZZZNZZZZVVRR
PPPPPPBBBBBBBBBBBBAAAANNNNNNNNNNNNZZZUUUUUBBBMBBBBBBBBBBBBDDDDDDDROOOOOOOOOOOOPOOOOOOOHIIIIIIAACCCAAAAAAAAAAAAWWWWWBIIIIIIIIIOOUUZZZZZRZRRRR
PPPPPBBBBBBBBBBBBAAAANNNNNNNNNNNNNNUUUUUUUUBBMMBBBBBBBBBBBDOOOOOOOOOOOOOOOOOOOPOPOOOOOOIIIICICACUUUUAAAAAAAAAAWWWEWBIIIIIIIIIIUUUZUUZRRRRRRR
VPPPBBBBBBBBBBBBAAAAAARRRRRNNNNNNNNUUUUUUUUUMMMMBBBBBBBBDDDOOOOOOOOOOOOOOOOOOOPPPPOOOIIIIICCCCCCCUUUUAAAAAAAWWWWWEWBIIIIIIUIIIUUUUUUUURRRRRR
VPVPUBBBBBBBBBBBBAARRRRRRRRRNNNNNNNUUUUUUUUMAAMMBBBBBBDDDDDOOOOOOOOOOOOOOOOOPPPPPPOOOOIIIIICCCCCUUUMUUUAAAAVWWWEWEEIIIIITUUUUUUUUUUUUURRRRRR
VVVVBBBBBBBDDDYBAAARRRRRRRRRNUNNUUUUUUUUUUUMMMMMBBBBBBBDDDDOOOOOOOOORKKKKRRPPPPPPLPPOOIIIIICCCCCCCUUUUUAAWSSSSSEEEEEEEEETTTUUUUUUUUUUURRRRRR
VVVVBBBBBBDDDDDBOAARRRRRRRRRUUUUUUUUUUUUUUMMMMMMBBBBBBBDDDDDDDKNDRRRRKKKKKRRRPPPPLPPIIIIIIICCCCCCCUUUUUUUUSSSSSSEEEEEEETTTTEUUUUUUUUUURRRRRR
VVVVVVVNDDDDDDDDOOOORRRRRRRRRUUUUUUUUUUUUUUUMZXXBBBBBHBDDDDDDHKKKKKKKKKKKKRRRRPPPPPPIIIIIIICCCCCCUUUUUUUUUSSSSSSSSSEEETTTTTUUUUUUDDUUURRRRRR
VVVVVVVDDDDDDDDDOOOORRRRRRRUUUUUUUUUUUUUUUUUZZZBBBBBBBDDDDDDDDKJJKKKKKKKKKKKKKPPPPPPIIIIIICCCCCCCUUUUUUUNNSSSSSSSMMEMETTTTTTUUQQDDDDQUURRRRR
VVVVVVVVDDDDDDOOOOOORRRRRRUUUUUUUUUUUUUUUUUUUZZBBBUUUUDDDDDDDKKJJKKKKKQKKKKKKGPPPPPPPIIIIIIICCCCCUUUUUUUNSSSSSSSSMMEMEETTTTTUUQQQQDDQQQPPPPP
VVVVVVVHHDDDDDDOOOOOORRRRRRRJUUUUUUUUUUUUUUZZZZZXBZZZDDDDDDDDJJJJJKKKKKKKKKKKGFPVPPPPIIIIICCCCCQCUUUUUUUUTUSSSSSMMMMMMETTTTTUQQQQQDDQQQPPPPP
VVVVVVHHHDDDDDDOOOOOOORRRRRRJUSJUUJUUUUUHUZZZZZZXZZAAADDDDGGDJJJJKKKKKKKKKKKKKFPPFPPIIIIIIIIIIIIUUUUUUUUUUUUSSSSSSMMMUCCTCTTTTQAQQQQQQQPPPPZ
VVVVVVHHHDSDDOOOOOOOOORRRRRRJUSJJJJZUZZUZZZZZZZZZZZAADDDDDGGDJJJJKKKKKKKIKKFFFFPFFIIIIIIIIIIIIIUUUUUUUUUUUUUSSSSSSMUUUCCCCCCCCAAAQQQQQQQPPPP
VVVVVVHHNNNODOOOOOOOOORRRRRRJJJJJJAZZZZZZZZZZZZZZZDDDDDDDDGGGJJJKKKKKKKKKKKFFFFFFFIFIIIIIIIIIIIIUUUUUUUUUYUNSSSSSSMSUUCCCCCCCCAAAAAAAAQQQQQQ
VVNNNVHHNNNOOOOOOOOOOOOJAARJJJJGJJJZZZZZZZZZZPPPZZDDDDDDDDDGGJJJCCKKKKKKKKFFFFFFFFFFFIIIIIIIIIIUUUUUUUUUUUNNSSSSSSSSSCCCCCCCAAAAAAAAAAAQQQQQ
VVNNNNNNNNNOOOOOOOOOOOOJJJJJJJJJJJJZZZZZZZZZZPPPZZZDDDDDDDDDDDDCCCCKKKKKCFFFFFFFFFFFGGIIIIIIIIIUUUUNNUNNNNNSSSSSSSSSSSCCCCCCAAAAAAAAAAQQQQQQ
TTTNNNNNNNNOOOOOOOOOOOOJJJJJJJJJJJJZZZZZZZZPPPPPPPZDDDDDDDDDDDDDCCKKKKKCCCFFFFFFFFTFRRRRRIIIIAAAXUUNNNNNNNSSSSSSSSSSSZCCCCCCAAAAAAAAAZEQQQQQ
TNNNNNNNNNNNNOOOOOOOOOOJJJJJJJJJJJJZZZZZZZZPPPPPPPPDDDDDDDDDDDDCCCKCCCCCCCCCFFFFFFRRRRRRRRIIIAAAUUUUNNNNNISSSSSSSSSSZZCVCCCCAAAAAAAAAZZQQQQQ
TNNNNNNNNNNNNOOOOOOOOOOJJJJJJJJJJJJJJZZZZPPPPPPPPPPDDDDDDDDDDDDDCCCCCCCCCCCCFFFXFFIIRRRRRRAIIAAAFFUNNNIINISSSSSSSSSSSSSSCCCCCAAAAAAAZZZZQQQQ
TNNNNNNNNNNNOOOPOOOOOOOLJJJJJJJJJJJJJZZZZPPPPPPPPPPDHDDDDDDDDYDDDCCCCCCCCCCCXSFXXXXIRRRRRRAAAAAAAANNNIIIIIISSSSSSSSSSSSSSSSCOAAAAAAAZZAZQQQQ
NNNNNNNNNNNUUOPPPPPPOOOJJJJJJJJJJJJJZZZTTTPPPPPPPPPPHDDDDDDDDYDDDDCCCCCCCCCXXXXXXXXXRRRRRRRRAAAAAANNNIIIIIISSISSSSSSSSSSSSSSOAAAAAAAAAAAQQQQ
NNNNNNNNNNNUUPPPPPPPPOOJYYJJJJJJJJJJZZZTTTTTTTTTPPNNDDDDDDDDDDDDDCCCCCCCCCCXXXXXXXXXXXRRRRRAAAAAAANNNIIIIIIIIISSSSSSSSSSSSRRAAAAAAFFAAAAAQQQ
NNNNNNUNNNPUUUUPPPPPPPPPJJJJJJJJJJJJZZZTTTTTTTTTPPPNNDDDDDDDDDDDDCCCCCCCCCCXXXXXXXXXXXRRRRRAAAAAANNNNIIIIIIIIISSSSSSFFRRSRRRAAAEFFFFAAAAAAQQ
NNNNNNUUPPPUUUPPPPPPPPPBIBJJJJJJTTTTTTTTTTTTTTTTPPPNNNYDDDDDDDDDDCCCCCCCCCCCXXXXXXXXXXRRRRRAAARJNNNNNIIIIIIIISSSSSSSFFRRRRRRRREEFFFFTAFFVRQQ
NCNNNNUUPPPPUUUPPPPPPPBBBBCJBJJJTTTTTTTTTTTTTTTTPPPPYNYYDVDDDDDDDDCCCCCCCCCCXXXXXXXXXXRRRRRRRRRJJJNJJIIIIIIIISSSFFFFFFFFRRRRRRREFFFFFFFFRRRR
CCCNUNUUPPPPUUPPPPPPBPBBBBBBBJBBTTTTTTTTTTTTTTTTPPPYYYYYVVDDDDDDDDCCCCCCCCCCBXXXXXXXRRRRRRRRRRRJJJJJJJIIIISSSSSSFFFFFRRRRRRRRXFFFFFFFFFFRRRR
CCCCUUUUPPPPUUBPPPPPBBBBBBBBBBBBTTTTTTTTTTTTTTTTPPPYYYYYDDDDDDDEDCCCCCCCCCKKKKKKKKKKRRRRRRRRJJJJJJJJJJIJJJJSSSSSFFFFFRRRRRRRRXFFFFFFFGFRRRRR
CCCUUUUUUPPPPUUPPPPPTTTBBBBBBBBBTTTTTTTTTTTTTTTTPPPYYYYYDDDDDDDDDCCCRCCCCCKKKKKKKKKKKKKKKKKKKJJJJJJJJJJJJJOSJSSSFFFFFFRRRRRRRRRFFFFFRGRRRRRR
CCCUUUUUPPUUPUIPPPPPTTBBBBBBBBBYTTTTTTTTTTTTTTTTBBPPPYYYYYDDDDDDDCCCCCCCCCKKKKKKKKKKKKKKKKKKKJJJJJJJJJJJJJJJJSSSFFFFRRRRRRRRRRRQQFQQRRRRRRRR
CCUUUUUUUUUUUNGGTPPPTTBBBBBBBBBYTTTTTTTTTTTTTTTTGBGYYYYYYYYDDDDDDDCCCCCCBCKKKKKKKKKKKKKKKKKKKJJJJJJJJJJJJJJJJSSFFFFFRRRRRRRRRRRQQFQQRRRRRRRR
UUUUUUUUUUUUUGGGTPTTTTTBBBBBBBBBYYYYTTTTTTGGGGGGGGGGGYYYYYYDDDDDDNCCCCCCBBKKKKKKKKKKKKKKKKKKKJJJJJJJJJJJJJJJJJFFJFFFRRRRRRRRRRQQQQQQQRRRRRRR
UUUUUUUUUUUUUGGGTTTTSTBBBBBBBBBYYYYYTTTTTTGGGGGGGGGGGYYYYYYYDGDDDDFCCCCBBBKKKKKKKKKKKKKKKKKKKJJJJJJJJJJJJYJJJJJJJFRRRRRRRRHWRRRQQQQQQRRRRRRR
UUUUUUUUUGUUGGGGGGGSSTSSBBBBBBBBYYYYYYYYYWGGGGGGGGGGYYYYYYYGGGGGGGFCCCCBBBKKKKKKKKKKKKKKKKKKKJJJJJJJJJJJYYJJJJJJJJJRRRRRFRHWWWWQQQQQQRRRRRRR
UUUUUUUUUUAUGGGGGGSSSSSSSBBBBBBYYYYYYYYYWWGGGGGGGGGYYYYYYYYGGGFGFFFFFCBBBBKKKKKKKKKKKKKKKKKKKUJJJJJJJJJJYYJJJJJJJJJJRRRRRWWWWWWWQQQQQRLLRRRR
GUUUUUUUUUGGGGGGGGSSSSSSSSBBBBBYYYYYYYWYWWWGGGGGGGPPGJYYYYYYFFFFFFFFFFFFBBBBBBBBBBBKKKKKKKKKKUJJJJJJJYYYYYYJJZJJJJJJJRJRBWWWWWWWWWTQQLLLLRRR
GUUUUUUUUUUGGGGGGGGSSSSSSSSRYYYYYYYYYYWWWWWWGGGGGGGPGGYYYYYFFFFFFIFFFFFBBBBBBBBBBBCKKKKKKKKKKUUJJJJJYYYYYYYJJZJJJJJJJJJWWWWWWWWWWWQQQLLLLLLR
GGGUUUUUUUGGBBBCCBBSSSSSSSSRYYYYYYYMMWWWWWWWGGGGGGGGGYYYYYYFFFFFFFFFFFFFFFBBBBMMBBCKKKKKKKKKKUUUJJJJJJJYYZZZDZZJJJJJJJWWJWMWWWWWWWLLLLLLLLLL
GGGGUUUUGGGGBBCCCBBPPSSSSSSSSSOOMMYMWWWKKWWWGGGGGGGGEEEEYYYDFDDFFFFFFFFFFFBBBBBMBBCCCKKKKKKKKUUUJPPJJYYYYYZZZZJJJJJJJJJWJWWWWWWFWWWLLLLLLLLL
GGGGGUUUGGGGBBBCBBBBBBRSSSSSSBMMMMMMMWWKKKKWGGGGGGGEEEEEYYYDEDMMMFFJJFFCMMBBBMMMCCCCHCUUUUUUUUUUUUPPPPPYYYYZZZZZJJJJJJJJJJWCWWWWWLLLLLLLLXLX
PGGGGGGGGBBBBBBBBBBBBBBSSSSSSBBBMMMMMWKKKKKKGGGGGGGGEEEEEDRDDDMDDDDJJJJJMMMMMMMMMCMCHCUUUUUUUUUUUUPEPEYYYYYZZZZJJJJJJJJJJJWCCWWWWTTLLLLLXXXX
PGGGGGGDGGBBBBBBBBBBBBBIISSSSSBBMMMMMKKKKKKKKKGGGGGBBBBEBDDDDDDDDDDJJJJMMMMMMMMMMMMHHCUUUUUUUUUUUUPEEEEYYYYZZZZJJJJJJJJJJJCCCWWWWTTLLXXLXXXX
PPPGGDDDDBBBBBBBBBBBBNBISSSSSSBBBMMMMKKKKKKKKKKGGLBBBBBBBDDDDDDDDDDJJJJMMMMMMMMMMHHHHHHHHHUUUUUUUPPPEEEEEYZZZZZJJJJJJJCCCJCCCWWCCTTTLLXXXXXX
PPPGGDDDDDDBBBBBBBBNNNBBSSSSSSSBBBMMMMKKKKKKKKGGABBBBBBBBDDDDDDDDJJJJJJJJMMMMMMMMMHHHHHHHHHUUUUUUUPEEEEECZZZZZZZZJJJJCCRCCCCCCCCTTTTLLLXXXXX
PPPPGDDDDDBBBBBBBBBNNNNNNMSSSSSSBBMBBBBKKKKKKKKKKKBBBBBBBBBYDDDDDJJJJJJYYYYMMMMMMMHHHHHHHHHUEEUUUZEEEEEECZZZZZZZZZJJJCCCCCCCCTTTTTTTLXXXXXXX
PPPBPRDDDDKBBBBBBBBBNNNNMMSSSSSBBBBBBBBKKKKKKKKKKKBBBBBBBBBDDDDDDJJEEEEYYYYMMMMMMMHHHHHHHHUUEEEEEEEEEEEZZPZZZZZZZZJJAECCCCCCCHHHTTTTWXWXXXXX
PPPPPRRDDVBBBBBBBMMMMNNNMMMSSSZZBBBBBBBKKKKKKKKKKBBBBBBBBBBDDDDDDJEEEEEEEEYMAMMMMMMMMHPHHHUUUEEEEEEEEEEZZZZZZZZZZZZJAACCCCCHHHHTTTTTWWWWWWWX
PPPPPPPPVVVBBBBBBNNMMMMMMSSSZZZZZBBBBBKKKKKKKKKKKBBBBBBBBBBBDDDDDJJEEEEEEEEMAMMMMMMMMMMMMHHUUEEEEEEEEEZZZZZZZZZZZZZAAAACCCCCHHHTTTTTMWWWWWWX
PPPPPPPPPVVBBBBBBMMMMMMMMMMZZZZZZZZZBBKKKKKKKKKKBBBBBBBBBBBBDGDQEEEEEEEEEEEEEOMMMMMMMMUCUUUUUUEEEEEEEEEZZZZZZZZZZZZBAAAAACCCCAHHHHWMMWWWWWWX
PPPPPPPPNDDDBBBBMUMMMMMMMMMMMZZZZZZBBZKKKKKKKKKKBBBBBBBBBBBLDBUEEEEEEEEEEDDDDDDDDDDDDMUUUUUUUEEEEEEEEEEZZZZZZZZZZZAAAAAAAACAZAHHHWWWWWWWWWWW
PPPPPPPPDDDDGBBBMMMMMMMMMMMMMMZZZZZZZZKKKKKKKKKKBBBBBBBBBBBBBBBEEEEEEEEEEDDDDDDDDDDDDJUYUUUUUEEEEEEEZZZZZZZZZZZZWWAAAAAAAAAAAAAAWWWWWWWWWWWW
PPPPDDDDDDDGGBBMMMMMMMMMMMMMMMZZZZZZZZZZKKDKKKKKBBIBIIBBBBBBBQEEEEEEEEEEEDDDDDDDDDDDDJJYUUUUUEEEEEEEZHZZZZZZZZZZZAAAAAAAAAAAAAAAWWWWWWWWWWWW
PDDDDDDDDDDDDDDFFMMMMMMMMMMMMZZZZZZZZZZZKKKKKKKDDIIIIIIBBBBBBBEEEPPEEEEEEEEEEEEDDDDDDYYYUUUUUUEEEEEEZZZZZZZZZZZZZAAAAAAAAAAAAAAAGWWWWWWWWWWW
PDDDDDDDDDDDDFFFFMMAAAMMMMPMZZZZZZZZZZSZZWKDDDDDDIIIIIIIIBBBBBHEEPPPEEEEEEEEEEEDDDDDDYYYUUUUUEEEEEEEZZZZZHHHHHHHHHHAAAAAAAAAAAAAWWWWWWWWWWWW
DDDDDDDDDDDDDFFFFFFAAAMMMMMMZZZZZZZZZZZZZZZZDDDDDIIIIIIIIIBBLBPPVPPPEPEEEEEEEEEDDDDDDYYYYYUUUUUHEEEEZZZZZHHHHHHHHHHHAAAAAAAAAAAAWWWWWWWWWWWW
DDDDDDDDDDDDXXFFFFFAAAMMMMMMZZZZZZZZZZZZZZDDDDDDDIIIIIIIIILLLPPPPPPPEPPPPEEEEEEDDDDDDYYYYYUUUHHHHHZZZZZZZHHHHHHHHHVVVAAAAAAAAAAAWWWWWWWWWWWW
DDDDDDDDDDDSXXFFFFFAAAMMMAZZZZZZZZZZZZZZOZIIDZZZZZIIIIIIIILLLPPPPPPPPPPPPPPPEELDDDDDDYYYYYUUUHHHHHZZZZZZZHHHHHHGHVVAAAAAAAAAAAAAAWWWWWWWWWWW
DDDDDDDDDDXXXXFFFFAAAAAMAAAZZZZZZZZZZZZZOOIIDDZZIIIIIIIIIILLLPPPPPPPPPPPPPPPGLLLGDDDDYYYYYUHHHHHHHZZZZZHHHHHHHHHHVVVAAAAAAAAAWWAFWWWWWWWWWWW
DDDDDDDDDDDXXXFFFAAAAAAAAAAZZZZZZZZZZRRIIIIIIIZZZZIIIIIIIILLZPPPPPPPPPPPPPGGGGLLGDDDDYYYYYUUUUUHHHZZZZZHIHHHHHVVVVVAAAAAAAAAAAAFFWWWWWWWQWQW
DDDDDDDDDDDXXFFFFAAAAAAAAAAAAAAZZZZZZIIIIIIIIIIIZZIZIIIIIILZZZPPPPPPPPPPJPGGJGLGGGGGYYYYYYUUUUUIIIPIIIHHIIHHHVVVVVUUUUAAAFAAAFFFFWWWWWWQQQQQ
NDDDDDDDDDDXXFFFFAAAAAAAAAAAAAAZZZZIIIIIIIIIIIIIIZIZZIIIIIZZZXPPPPPPPPPJJPDGGGGGGGGGNGYYYYYUUUUUIIIIIIHHIIIIHVVVVUUUUUUUAFAAAFFFFFFWQWQQQQQQ
DDDDDDFDDFFFXFFFAAAAAAAAAAAAAAAXZXZZIIIIIIIIIIIIZZZZZIIIIZZZZPPPPPPPPPPPPPGGGGGGGGGGGGYYYYYUUJJUIIIIIIIIIIIVVVVVUUUUUUUUAFFFFFFFFFQQQQQQQQQQ
VVDDDDDFFFFFXFFFFAAAAAAAAAAAAXXXXXXZIIIIIIIIIIIIIZZZZZZZZZZZZPPPPPPPPPPDGGGGGGGGGGGGGGYYYYYUJJJJJJIIIIIIIIIIIIVVUUUUUUUUUUUFFFFFFFFQQQQQFFQQ
VVDDDFFFFFFFFFFFFAAAAAAAAAAAXXXXXXIIIIIIIIIIIIIIZZZZZZZZZZZZZPPPPPPPPPPPDGGGGGGGGGGGGGGGYYYUUUJJJJIIIIIIIIIIIVVVUUUUUUUUUUUUFFFFFFFQQQFFFFFQ
VVFFFFFFFFFFFFFFFAAAAAAAAAAAXXXXXXIPIIIIIIIIIIZZZZZZZZZZZZZZZDDDDDDPPPPDDDGGGGGGGGGGGGGGYYYYYJJJJIIIIIIIIIIIVVUUUUUUUUUUUUUUUFFFFFFQFFFFFFFF
FVFFFFFFFFFFFFFFFAAAAAAAAAAXXXXXXXIIIIIIIIIIIIZZZZZZZZZZZZZZZDDDDDDDPDDDDGGGGGGGGGGGGGGGYYYYJJJJJJJIIIIIIIIIVUUUUUUUUUUUUUUUUFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFFFFAAAAATTAXXXXXXIIIIIIIIIIIIIIIZZZZZZZZZZZZZZDDDDDDDDDDDDDGGGGGGGGGGGGGGJJJJJJJJJJJJIIIIIIIIVVVUUUUUUUUUUUUUFFFFFFFFFFFFFFFF'''

def part1(puzzle_input):
    grid = puzzle_input.split()
    m = len(grid)
    n = len(grid[0])

    def find_region(i, j):
        plant = grid[i][j]
        visited = set()
        fence = 0
        queue = [(i, j)] 
        while queue:
            i, j = queue.pop()
            if (i, j) in visited:
                continue
            if i not in range(m) or j not in range(n) or grid[i][j] != plant:
                fence += 1
                continue
            visited.add((i, j))
            for x, y in [(1, 0), (0, 1), (-1, 0), (0, -1)]:
                if (i+x, j+y) not in visited:
                    queue.append((i+x, j+y))

        return visited, len(visited) * fence

    total = 0
    visited = set()
    for i in range(m):
        for j in range(n):
            if (i, j) not in visited:
                region, cost = find_region(i, j)
                visited |= region
                total += cost

    return total
print(part1(puzzle_input))